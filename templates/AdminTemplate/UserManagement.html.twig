{% extends "base.html.twig" %}

{% block MainContent %}
{# <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">    #}
 {# <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>  #}
{# <link rel="stylesheet" href="http://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css"></style> #}
<link rel="stylesheet"
		href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/fontawesome.min.css">
        	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
	<link href="https://fonts.googleapis.com/css2?family=League+Gothic&family=Roboto&display=swap" rel="stylesheet">
<link rel="stylesheet" href="{{asset('css/styleTable.css')}}"></style>
<style>
.validator-message{
    color: red;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: 12px;
}
</style>
{# <script type="text/javascript" src="http://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script> #}
			<div class="content ">
				<div class="d-flex align-items-center justify-content-between mb-3 ">
				
					<button  class="btn btn-primary rounded-circle" id="open-popup-Admin" type="button" 
						style="
						font-size: 1rem;
						padding: 3px !important;
						width: 33px;
						height: 33px;
						border-radius: 50%;
            position: absolute;
            top: 12.5%;
            right: 4%;
						"
					>
						<i class="fas fa-plus"></i>
					</button>

					<div id="popup-container-Admin" class="" style="width: 28%;">
						<button id="close-popup-Admin"><i class="fas fa-times"></i></button>
						<div id="popup-content-Admin" class="">
							
							<h4 class="model-titel">Ajouter Un Coach </h4>
                {{form_start(formCoach)}}
								<label for="name">prénom:</label>
								<span class="input-icon-Admin-name" id="name-icon"><i class="fas fa-user"></i></span>
								{# <input type="text" placeholder="" id="name" class="asass" name="name" required> #}
                {{form_widget(formCoach.firstName , {'attr':{'class':'name'}})}}
                <div class="validator-message" id='errorFirstNameCoach'>
                                       
                 </div>
						  		<label for="name">nom:</label>
								<span class="input-icon-Admin-name1" id="name-icon1"><i class="fas fa-user"></i></span>
								{# <input type="text" placeholder="" id="name" class="asass" name="name" required> #}
                {{form_widget(formCoach.lastName , {'attr':{'class':'lastname'}})}}
                <div class="validator-message" id='errorLastNameCoach'>
                                       
                 </div>
								<label for="email">Email:</label>
								<div class="input-group-prepend">
								<span class="input-icon-Admin-email" id="email-icon"><i class="fas fa-envelope"></i></span>
								</div>
								{# <input type="email" placeholder="" id="email" name="email" required> #}
						    {{form_widget(formCoach.email , {'attr':{'class':'email'}})}}
                <div class="validator-message" id='errorEmailCoach'>
                                       
                 </div>
								<label for="password">mot de Passe:</label>
								<span class="input-icon-Admin-password" id="password-icon"><i class="fas fa-lock"></i></span>
								{# <input type="password" placeholder="" id="password" name="password" required> #}
						  	{{form_widget(formCoach.password , {'attr':{'class':'password'}})}}
                <div class="validator-message" id='errorPasswordCoach'>
                                       
                 </div>
								<label for="phone">Téléphone:</label>
								<span class="input-icon-Admin-phoneNumber" id="phoneNumber-icon"><i class="fas fa-phone"></i></span>
								{# <input type="text" placeholder="" id="phoneNumber" name="phone" required> #}
						  	{{form_widget(formCoach.phonenumber , {'attr':{'class':'phoneNumber'}})}}
                <div class="validator-message" id='errorPhoneNumberCoach'>
                                       
                 </div>
                {{form_widget(formCoach.module)}}

								<div class="d-flex align-items-center justify-content-between mb-3  ">
									<button href="#" class="btn btn-secondary btn-block mt-3" name="cancel" style="border-radius: 5px;">Cancel</button>
                 {{ form_row(formCoach.signUp, {'attr': {'class': 'btn btn-primary btn-block mt-3', 'style': 'border-radius: 5px;'}}) }}

									{# <button href="#" class="btn btn-primary btn-block mt-3"   name="submit" style="border-radius: 5px;">Add</button> #}
									
								  </div>
                  {{form_end(formCoach)}}
							  
						</div>
					  </div>
					  <div id="popup-overlay-Admin"></div>
					  <script src="{{asset("js/script-popUp-admin.js")}}"></script>
				</div>
			
				
				<div class="container-fluid p-0">
					<main class="table" id="customers_table">
        <section class="table__header">
            <h1>Display Users</h1>
            <div class="input-group">
                <input id="inputSearch" type="search" placeholder="Search Data...">
                <img src="images/search.png" alt="">
            </div>
            <div class="export__file">
                <label for="export-file" class="export__file-btn" title="Export File"></label>
                <input type="checkbox" id="export-file">
                <div class="export__file-options">
                    <label>Export As &nbsp; &#10140;</label>
                    <label for="export-file" id="toPDF">PDF <img src="images/pdf.png" alt=""></label>
                    <label for="export-file" id="toJSON">JSON <img src="images/json.png" alt=""></label>
                    <label for="export-file" id="toCSV">CSV <img src="images/csv.png" alt=""></label>
                    <label for="export-file" id="toEXCEL">EXCEL <img src="images/excel.png" alt=""></label>
                </div>
            </div>
        </section>
        
        <section class="table__body">
            <table>
                <thead>
                    <tr>
                        <th> Id <span class="icon-arrow">&UpArrow;</span></th>
                        <th> UserName <span class="icon-arrow">&UpArrow;</span></th>
                        <th> Email <span class="icon-arrow">&UpArrow;</span></th>
                        <th> Status <span class="icon-arrow">&UpArrow;</span></th>
                        <th> State <span class="icon-arrow">&UpArrow;</span></th>
                        <th> Action <span class="icon-arrow">&UpArrow;</span></th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users %}
                <tr>
                <td>{{ user.id }}</td>
                <td><img src="{{user.profile.getPicture}}"> {{ user.userName }} </td>
                <td>{{ user.email }}</td>
                <td>{{ user.status }}</td>
                <td><p class="{% if user.state == 'Active' %}status delivered{% endif %} {% if user.state == 'Banned' %}status cancelled{% endif %}">{{ user.state }}</p></td>
                <td>
<form method="post" action="{{ path('app_user_delete', {'id': user.id}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');" style="display: inline-block;margin:10% cursor:pointer;">
    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ user.id) }}">
    <button style="border:none; background:transparent;"><i class="fa fa-trash" style="color:red;" aria-hidden="true"></i></button>
</form>   
                 <a href="{{ path('app_admin_banUser', {'id': user.id}) }}"><i class="fa fa-ban" aria-hidden="true"></i>
</a>
                    <a href="{{ path('app_admin_userDetails', {'id': user.id}) }}"><i class="fa fa-eye" aria-hidden="true"></i>
</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="7">no records found</td>
            </tr>
        {% endfor %}
                </tbody>
            </table>
        </section>
    </main>

	  </div>

    <script src="{{asset('js/scriptTable.js')}}"></script>
    <script>

    const search = document.getElementById('inputSearch'),
    table_rows = document.querySelectorAll('tbody tr'),
    table_headings = document.querySelectorAll('thead th');

// 1. Searching for specific data of HTML table
search.addEventListener('input', searchTable);
    function searchTable() {
    
    table_rows.forEach((row, i) => {
        let table_data = row.textContent.toLowerCase(),
            search_data = search.value.toLowerCase();

        row.classList.toggle('hide', table_data.indexOf(search_data) < 0);
        row.style.setProperty('--delay', i / 25 + 's');
    })

    document.querySelectorAll('tbody tr:not(.hide)').forEach((visible_row, i) => {
        visible_row.style.backgroundColor = (i % 2 == 0) ? 'transparent' : '#0000000b';
    });
}
    </script>
<script>
$(document).ready(function(){
    $('#myTable').dataTable();
});
</script> 
					
			</div>

            {# <input type="text" class="recherche" name="" id="myInput" placeholder="cherhcer" oninput="searchFun()"> #}
            <script>
	function searchFun() {
    var input, filter, table, tr, td, i, j, txtValue;
    input = document.getElementById("myInput");
    filter = input.value.toUpperCase();
    table = document.getElementById("myTable");
    tr = table.getElementsByTagName("tr");
    for (i = 1; i < tr.length; i++) {
        // loop through all the td elements of the current row
        for (j = 0; j < tr[i].cells.length; j++) {
            td = tr[i].cells[j];
            if (td) {
                txtValue = td.textContent || td.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                    break; // exit the loop if a match is found
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }
}
</script>
<script language = "javascript" 
      src = "https://code.jquery.com/jquery-2.2.4.min.js">
    </script> 
  <script language = "javascript">  
      $(document).ready(function(){   
        
      //------------EmailStart-----------------------------------------------
          $("#coach_email").on("keyup", function(event){ 
            const obj = {
                firstname :      document.coach.coach_firstName.value,
                lastname :       document.coach.coach_lastName.value,
                email :          document.coach.coach_email.value,
                phoneNumber :    document.coach.coach_phonenumber.value,
                password :    document.coach.coach_password.value,
                };


            $.ajax({  
               url: "{{path('app_userCoach_controle')}}",  
               type: 'POST',   
               dataType: 'json',  
               data: obj,
               async: true,  
               
               success: function(data, status) {  
                 if(data['email'] == null)
                 {
                    document.getElementById('errorEmailCoach').innerHTML = '';
                 } 
                 else
                 {
                    document.getElementById('errorEmailCoach').innerHTML = data['email'];
                    console.log(data);
                }
               },  
               error : function(xhr, textStatus, errorThrown) {  
                    console.log(xhr);
                  alert(textStatus+' Ajax request failed.'+ errorThrown+" "+xhr);  
               }  
            });  
          });
         //---------------------------------
              $("#coach_firstName").on("keyup", function(event){ 
            const obj = {
                firstname :      document.coach.coach_firstName.value,
                lastname :       document.coach.coach_lastName.value,
                email :          document.coach.coach_email.value,
                phoneNumber :    document.coach.coach_phonenumber.value,
                password :    document.coach.coach_password.value,
                };

console.log("tesy");
            $.ajax({  
               url: "{{path('app_userCoach_controle')}}",  
               type: 'POST',   
               dataType: 'json',  
               data: obj,
               async: true,  
               
               success: function(data, status) {  
                 if(data['firstName'] == null)
                 {
                    document.getElementById('errorFirstNameCoach').innerHTML = '';
                 } 
                 else
                 {
                    document.getElementById('errorFirstNameCoach').innerHTML = data['firstName'];
                    console.log(data);
                }
               },  
               error : function(xhr, textStatus, errorThrown) {  
                    console.log(xhr);
                  alert(textStatus+' Ajax request failed.'+ errorThrown+" "+xhr);  
               }  
            }); }); 
            //-----------------------------
                   $("#coach_lastName").on("keyup", function(event){ 
            const obj = {
                firstname :      document.coach.coach_firstName.value,
                lastname :       document.coach.coach_lastName.value,
                email :          document.coach.coach_email.value,
                phoneNumber :    document.coach.coach_phonenumber.value,
                password :    document.coach.coach_password.value,
                };

console.log("tesy");
            $.ajax({  
               url: "{{path('app_userCoach_controle')}}",  
               type: 'POST',   
               dataType: 'json',  
               data: obj,
               async: true,  
               
               success: function(data, status) {  
                 if(data['lastName'] == null)
                 {
                    document.getElementById('errorLastNameCoach').innerHTML = '';
                 } 
                 else
                 {
                    document.getElementById('errorLastNameCoach').innerHTML = data['lastName'];
                    console.log(data);
                }
               },  
               error : function(xhr, textStatus, errorThrown) {  
                    console.log(xhr);
                  alert(textStatus+' Ajax request failed.'+ errorThrown+" "+xhr);  
               }  
            }); }); 
            //-----------------------------
                   $("#coach_password").on("keyup", function(event){ 
            const obj = {
                firstname :      document.coach.coach_firstName.value,
                lastname :       document.coach.coach_lastName.value,
                email :          document.coach.coach_email.value,
                phoneNumber :    document.coach.coach_phonenumber.value,
                password :    document.coach.coach_password.value,
                };

console.log("tesy");
            $.ajax({  
               url: "{{path('app_userCoach_controle')}}",  
               type: 'POST',   
               dataType: 'json',  
               data: obj,
               async: true,  
               
               success: function(data, status) {  
                 if(data['password'] == null)
                 {
                    document.getElementById('errorPasswordCoach').innerHTML = '';
                 } 
                 else
                 {
                    document.getElementById('errorPasswordCoach').innerHTML = data['password'];
                    console.log(data);
                }
               },  
               error : function(xhr, textStatus, errorThrown) {  
                    console.log(xhr);
                  alert(textStatus+' Ajax request failed.'+ errorThrown+" "+xhr);  
               }  
            }); }); 
            //-----------------------------
                   $("#coach_phonenumber").on("keyup", function(event){ 
            const obj = {
                firstname :      document.coach.coach_firstName.value,
                lastname :       document.coach.coach_lastName.value,
                email :          document.coach.coach_email.value,
                phoneNumber :    document.coach.coach_phonenumber.value,
                password :    document.coach.coach_password.value,
                };

console.log("tesy");
            $.ajax({  
               url: "{{path('app_userCoach_controle')}}",  
               type: 'POST',   
               dataType: 'json',  
               data: obj,
               async: true,  
               
               success: function(data, status) {  
                 if(data['phoneNumber'] == null)
                 {
                    document.getElementById('errorPhoneNumberCoach').innerHTML = '';
                 } 
                 else
                 {
                    document.getElementById('errorPhoneNumberCoach').innerHTML = data['phoneNumber'];
                    console.log(data);
                }
               },  
               error : function(xhr, textStatus, errorThrown) {  
                    console.log(xhr);
                  alert(textStatus+' Ajax request failed.'+ errorThrown+" "+xhr);  
               }  
            }); }); 
            //-----------------------------

             $("#coach_signUp").on("click", function(event){ 
        if(
            document.getElementById('errorFirstNameCoach').innerHTML != "" ||
            document.getElementById('errorLastNameCoach').innerHTML != "" ||
            document.getElementById('errorEmailCoach').innerHTML != "" ||
            document.getElementById('errorPasswordCoach').innerHTML != "" ||
            document.getElementById('errorPhoneNumberCoach').innerHTML != "" 
       
              )
        {
            event.preventDefault();
        }  
    });
         });
         </script>
{% endblock %}